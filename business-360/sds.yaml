apiVersion: v1
sections:
  - label: High Availability
    fields:
      - field: mirrored
        type: boolean
        label: Mirroring Support
        help: If you enable mirroring, then it's mirrored
        value: "false"
endpointDependencies:
 - dependency: jdbc
   endpointType: intersystems-iris-jdbc
   reason: Select the endpoint for FS Data Lake if you are giving a demo of TotalView for Asset Management
   chartField: fsDataLakeDemoJDBCURL
   optional: true
secrets:
- field: requiredSecrets.irisLicense
  type: intersystems-iris-license
  reason: The IRIS License to be used with this deployment
- field: requiredSecrets.atScaleLicense
  type: atscale-license
  reason: The AtScale License to be used with this deployment
- field: requiredSecrets.intersystemsContainerRegistrySecret
  type: image-pull-secret
  subType: containers.intersystems.com
  reason: These are the credentials to authenticate with containers.intersystems.com
EULSA: https://www.intersystems.com/EULSA-Docs/InterSystems_IRIS_Cloud_End_User-8_14_19.pdf
compute:
  computeSpecs:
    - name: database
      label: Database Node Spec.
      categoryFilter: CO,MO,GP
      minCPU: 4
      suggestedCPU: 4
      minRAM: 4
      suggestedRAM: 8
      nodeSelectorField: compute.database.nodeTypeSelector
      cpuRequestField: compute.database.cpu
      memoryRequestField: compute.database.memory
      help: Specifies how many cores and how much memory the database will be using
    - name: frontend
      label: Front End Node Spec.
      categoryFilter: CO,MO,GP
      minCPU: 4
      maxCPU: 8
      suggestedCPU: 4
      minRAM: 4
      maxRAM: 16
      suggestedRAM: 8
      nodeSelectorField: compute.frontend.nodeTypeSelector
      cpuRequestField: compute.frontend.cpu
      memoryRequestField: compute.frontend.memory
      help: Specifies how many cores and how much memory the front end will be using
    - name: irisaa
      label: IRISAA Node Spec.
      categoryFilter: CO,MO,GP
      minCPU: 4
      maxCPU: 16
      suggestedCPU: 8
      minRAM: 16
      maxRAM: 16
      suggestedRAM: 16
      nodeSelectorField: compute.irisaa.nodeTypeSelector
      cpuRequestField: compute.irisaa.cpu
      memoryRequestField: compute.irisaa.memory
      help: Specifies how many cores and how much memory the IRISAA instance will be using.
storage:
  storageSpecs:
    - name: database
      label: Database
      sizeField: storageDB.size
      storageClassField: storageDB.storageClass
      help: This is the storage reserved for your database...
    - name: wij
      label: Write Image Journal
      sizeField: storageWIJ.size
      storageClassField: storageWIJ.storageClass
      help: This is the storage reserved for your database...
    - name: journal1
      label: Primary Journal
      sizeField: storageJournal1.size
      storageClassField: storageJournal1.storageClass
      help: This is the storage reserved for your primary journal data...
    - name: journal2
      label: Secondary Journal
      sizeField: storageJournal2.size
      storageClassField: storageJournal2.storageClass
      help: This is the storage reserved for your secondary journal data...
    - name: AtScaleData
      label: Volume for AtScale Data
      sizeField: storageData.size
      storageClassField: storageData.storageClass
      help: This volume stores all the data for AtScale.
    - name: AtScaleConf
      label: Volume for AtScale Configuration
      sizeField: storageConf.size
      storageClassField: storageConf.storageClass
      help: This volume will be used to store all the configuration for AtScale.
    - name: AtScaleLogs
      label: Volume for AtScale Logs
      sizeField: storageLogs.size
      storageClassField: storageLogs.storageClass
      help: This volume will be used to store all logs generated by AtScale so they won't be lost across multiple restarts of the service.
  allowCustom: false
  storageOptions:
    - name: Small
      help: Ideal for small workloads...
      storageOptionSpecs:
        - storageSpecName: database
          size: 100
          IOPS: 2000
        - storageSpecName: wij
          size: 50
          IOPS: 2000
        - storageSpecName: journal1
          size: 100
          IOPS: 2000
        - storageSpecName: journal2
          size: 100
          IOPS: 2000
        - storageSpecName: AtScaleData
          size: 100
          IOPS: 1000
        - storageSpecName: AtScaleConf
          size: 10
          IOPS: 500
        - storageSpecName: AtScaleLogs
          size: 10
          IOPS: 1000
externalServicesDeclarations:
  - name: super-server
    type: loadBalancer
    hostnameChartField: superServer.hostname
    loadBalancerPortChartField: superServer.port
    enabled: false
    enabledChartField: superServer.enabled
    label: Super Server Port
    description: Port through which JDBC/ODBC connections are made
  - name: management
    type: loadBalancer
    hostnameChartField: management.hostname
    loadBalancerPortChartField: management.port
    enabled: false
    enabledChartField: management.enabled
    label: Management Portal over Load Balancer
    description: Port to access the management portal over a Load Balancer
  - name: business360-frontend
    type: loadBalancer
    hostnameChartField: ui.hostname
    loadBalancerPortChartField: ui.port
    enabled: false
    enabledChartField: ui.enabled
    label: TotalView Demo UI
    description: Port to access the application UI over a Load Balancer
  - name: designer
    type: loadBalancer
    hostnameChartField: designer.loadBalancerDNSName
    loadBalancerPortChartField: designer.port
    enabled: false
    enabledChartField: designer.enabled
    label: Designer Portal
    description: AtScale designer and JDBC/MDX available outside the cluster
endpoints:
  - title: TotalView for Asset Management
    icon: bpleditor.png
    group: Business 360
    description: TotalView User Interface
    type: browsing
    url: http://{externalService.host}:{externalService.port}/
    contexts:
      - manage
    visibility: external
    presentation: link
    externalService: business360-frontend
  - title: Getting Started
    group: Documentation
    description: Learn more about...
    type: browsing
    url: https://gettingstarted.intersystems.com
    contexts:
      - catalog
      - documentation
    visibility: foreign
    presentation: link
  - title: Internal JDBC Endpoint
    contexts:
      - manage
    icon: bpleditor.png
    group: Connectivity
    description: Connect using JDBC
    visibility: internal
    presentation: apiEndpoint
    type: intersystems-iris-jdbc
    clusterIPService: iris-svc
    url: jdbc:IRIS://{clusterIPService.host}:1972/B360
  - title: Internal JDBC Endpoint for AtScale
    contexts:
      - manage
    icon: bpleditor.png
    group: Connectivity
    description: Connect using JDBC
    visibility: internal
    presentation: apiEndpoint
    type: atscale-jdbc
    clusterIPService: atscale-svc
    url: jdbc:hive2://{clusterIPService.host}:11111/default
  - title: Internal JDBC Endpoint for MDX
    contexts:
      - manage
    icon: bpleditor.png
    group: Connectivity
    description: Connect using MDX
    visibility: internal
    presentation: apiEndpoint
    type: atscale-mdx
    clusterIPService: atscale-svc
    url: http://{clusterIPService.host}:10502/xmla/default
  - title: External JDBC Endpoint
    contexts:
      - manage
    icon: bpleditor.png
    group: Connectivity
    description: Connect using JDBC from outside the cluster
    visibility: external
    externalService: super-server
    presentation: apiEndpoint
    type: intersystems-iris-jdbc
    url: jdbc:IRIS://{externalService.host}:{externalService.port}/B360
  - title: External JDBC Endpoint for AtScale
    contexts:
      - manage
    icon: bpleditor.png
    group: Connectivity
    description: Connect using JDBC from outside the cluster
    visibility: external
    externalService: designer
    presentation: apiEndpoint
    type: atscale-jdbc
    url: jdbc:hive2://{externalService.host}:11111/default
  - title: External JDBC Endpoint for MDX
    contexts:
      - manage
    icon: bpleditor.png
    group: Connectivity
    description: Connect using JDBC from outside the cluster
    visibility: external
    externalService: designer
    presentation: apiEndpoint
    type: atscale-mdx
    url: http://{externalService.host}:10502/xmla/default
  - title: Designer
    icon: bpleditor.png
    group: Designer
    description: Open Adaptive Analytics Designer
    type: browsing
    url: http://{externalService.host}:10500
    contexts: 
    - manage
    visibility: external
    presentation: link
    externalService: designer    
